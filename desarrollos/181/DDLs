create or replace TABLE SIT.DM_FLX_VISITOR_ORIGIN (
	VISITOR_ORIGIN_KEY NUMBER(16,0),
	VISITOR_ORIGIN_ID VARCHAR(20),
	VISITOR_ORIGIN_DES VARCHAR(100),
    VISITOR_ORIGIN_PARENT_DES VARCHAR(100),
	LOAD_TIME TIMESTAMP_LTZ(9) DEFAULT CURRENT_TIMESTAMP()
);

COPY INTO SIT.DM_FLX_VISITOR_ORIGIN (VISITOR_ORIGIN_KEY, VISITOR_ORIGIN_ID, VISITOR_ORIGIN_DES, VISITOR_ORIGIN_PARENT_DES, LOAD_TIME)
FROM (SELECT $1, $2, $3, $4, TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP) FROM '@s3_stage/flux_dt/DM_FLX_VISITOR_ORIGIN_V3.csv')
FILE_FORMAT = 'csv_format_dm' 
FORCE = TRUE 
ON_ERROR = 'CONTINUE';



create or replace TABLE SIT.DM_FLX_VISITOR_ORIGIN_MLG (
	VISITOR_ORIGIN_KEY NUMBER(16,0),
	LANGUAGE_KEY NUMBER(16,0),
	VISITOR_ORIGIN_DES VARCHAR(100),
    VISITOR_ORIGIN_PARENT_DES VARCHAR(100),
	LOAD_TIME TIMESTAMP_LTZ(9)
);

COPY INTO SIT.DM_FLX_VISITOR_ORIGIN_MLG (VISITOR_ORIGIN_KEY, LANGUAGE_KEY, VISITOR_ORIGIN_DES, VISITOR_ORIGIN_PARENT_DES, LOAD_TIME)
FROM (SELECT $1, $2, $3, $4, TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP) FROM '@s3_stage/flux_dt/DM_FLX_VISITOR_ORIGIN_MLG_V4.csv')
FILE_FORMAT = 'csv_format_dm' 
FORCE = TRUE 
ON_ERROR = 'CONTINUE';
