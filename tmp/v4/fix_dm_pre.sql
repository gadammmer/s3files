-- DM_GLB_COUNTRY_V10.csv
-- DM_GLB_COUNTRY_MLG_V9.csv
-- DM_IVE_KPI_MASTER_V5.csv
-- DM_IVE_KPI_MASTER_MLG_V6.csv
-- RL_COUNTRY_TRANSLATOR.csv


--- DM_GLB_COUNTRY ---

create or replace TABLE SIT.DM_GLB_COUNTRY (
	COUNTRY_KEY NUMBER(16,0),
	COUNTRY_ID VARCHAR(12),
	COUNTRY_DES VARCHAR(75),
	COUNTRY_NORM_DES VARCHAR(75),
	COUNTRY_SHORT_DES VARCHAR(15),
	COUNTRY_SHORT2_DES VARCHAR(15),
	COUNTRY_EUROSTAT_ID VARCHAR(15),
	ID_INE NUMBER(16,0),
	ID_ETR VARCHAR(15),
	ID_FRONTUR VARCHAR(15),
	ID_EGATUR VARCHAR(15),
	LOAD_TIME TIMESTAMP_NTZ(9)
);

COPY INTO SIT.DM_GLB_COUNTRY (
    COUNTRY_KEY, 
    COUNTRY_ID, 
    COUNTRY_DES, 
    COUNTRY_NORM_DES, 
    COUNTRY_SHORT_DES, 
    COUNTRY_SHORT2_DES, 
    COUNTRY_EUROSTAT_ID, 
    ID_INE, 
    ID_ETR, 
    ID_FRONTUR, 
    ID_EGATUR, 
    LOAD_TIME
)
FROM (
    SELECT 
        $1, 
        $2, 
        $3, 
        $4, 
        $5, 
        $6, 
        $7, 
        $8, 
        $9, 
        $10, 
        $11, 
        TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP)
    FROM '@s3_stage/global/DM_GLB_COUNTRY_V10.csv'
)
FILE_FORMAT = 'csv_format_dm' 
FORCE = TRUE 
ON_ERROR = 'CONTINUE';

---- DM_GLB_COUNTRY_MLG ----

create or replace TABLE SIT.DM_GLB_COUNTRY_MLG (
	COUNTRY_KEY NUMBER(16,0) NOT NULL,
	LANGUAGE_KEY NUMBER(16,0) NOT NULL,
	COUNTRY_DES VARCHAR(75),
	ID_INE NUMBER(16,0),
	LOAD_TIME TIMESTAMP_NTZ(9),
	primary key (COUNTRY_KEY, LANGUAGE_KEY)
);

COPY INTO SIT.DM_GLB_COUNTRY_MLG (
    COUNTRY_KEY, 
    LANGUAGE_KEY, 
    COUNTRY_DES, 
    ID_INE, 
    LOAD_TIME
)
FROM (
    SELECT 
        $1, 
        $2, 
        $3, 
        $4, 
        TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP)
    FROM '@s3_stage/global/DM_GLB_COUNTRY_MLG_V9.csv'
)
FILE_FORMAT = 'csv_format_dm' 
FORCE = TRUE 
ON_ERROR = 'CONTINUE';

---- DM_IVE_KPI_MASTER ----

create or replace TABLE SIT.DM_IVE_KPI_MASTER (
	KPI_KEY NUMBER(16,0),
	KPI_ID VARCHAR(100),
	KPI_DES VARCHAR(100),
	LOAD_TIME TIMESTAMP_NTZ(9)
);

COPY INTO SIT.DM_IVE_KPI_MASTER (
    KPI_KEY, 
    KPI_ID, 
    KPI_DES, 
    LOAD_TIME
)
FROM (
    SELECT 
        $1, 
        $2, 
        $3, 
        TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP)
    FROM '@s3_stage/ive_dt/DM_IVE_KPI_MASTER_V5.csv'
)
FILE_FORMAT = 'csv_format_dm' 
FORCE = TRUE 
ON_ERROR = 'CONTINUE';


---- DM_KPI_MASTER_MLG ----

create or replace TABLE SIT.DM_IVE_KPI_MASTER_MLG (
	KPI_KEY NUMBER(16,0),
	LANGUAGE_KEY NUMBER(16,0),
	KPI_ID VARCHAR(100),
	KPI_DES VARCHAR(100),
	LOAD_TIME TIMESTAMP_NTZ(9)
);

COPY INTO SIT.DM_IVE_KPI_MASTER_MLG (
    KPI_KEY, 
    LANGUAGE_KEY,
    KPI_ID, 
    KPI_DES, 
    LOAD_TIME
)
FROM (
    SELECT 
        $1, 
        $2, 
        $3, 
        $4,
        TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP)
    FROM '@s3_stage/ive_dt/DM_IVE_KPI_MASTER_MLG_V6.csv'
)
FILE_FORMAT = 'csv_format_dm' 
FORCE = TRUE 
ON_ERROR = 'CONTINUE';

--- RL_COUNTRY_TRANSLATOR ---

create or replace TABLE PROCESS.RL_COUNTRY_TRANSLATOR (
	RAW_COUNTRY_DES VARCHAR(200),
	ORIGIN_DATA_ID VARCHAR(200),
	COUNTRY_DES VARCHAR(200),
	COUNTRY_ID VARCHAR(200),
	LOAD_TIME TIMESTAMP_LTZ(9) DEFAULT CURRENT_TIMESTAMP()
);

COPY INTO PROCESS.RL_COUNTRY_TRANSLATOR (
    RAW_COUNTRY_DES, 
    ORIGIN_DATA_ID,
    COUNTRY_DES, 
    COUNTRY_ID, 
    LOAD_TIME
)
FROM (
    SELECT 
        $1, 
        $2, 
        $3, 
        $4,
        TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP)
    FROM '@s3_stage/flux_dt/RL_COUNTRY_TRANSLATOR.csv'
)
FILE_FORMAT = 'csv_format_dm' 
FORCE = TRUE 
ON_ERROR = 'CONTINUE';